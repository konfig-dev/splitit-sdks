"use strict";var E=Object.defineProperty;var ve=Object.getOwnPropertyDescriptor;var Ae=Object.getOwnPropertyNames;var je=Object.prototype.hasOwnProperty;var S=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Pe=(e,t)=>{for(var r in t)E(e,r,{get:t[r],enumerable:!0})},Se=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ae(t))!je.call(e,i)&&i!==r&&E(e,i,{get:()=>t[i],enumerable:!(n=ve(t,i))||n.enumerable});return e};var Ie=e=>Se(E({},"__esModule",{value:!0}),e);var W=S((Ke,z)=>{"use strict";var I,s,H={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},V;function b(e){throw{name:"SyntaxError",message:e,at:I,text:V}}function c(e){return e&&e!==s&&b("Expected '"+e+"' instead of '"+s+"'"),s=V.charAt(I),I+=1,s}function L(){var e,t="";for(s==="-"&&(t="-",c("-"));s>="0"&&s<="9";)t+=s,c();if(s===".")for(t+=".";c()&&s>="0"&&s<="9";)t+=s;if(s==="e"||s==="E")for(t+=s,c(),(s==="-"||s==="+")&&(t+=s,c());s>="0"&&s<="9";)t+=s,c();return e=Number(t),isFinite(e)||b("Bad number"),e}function N(){var e,t,r="",n;if(s==='"')for(;c();){if(s==='"')return c(),r;if(s==="\\")if(c(),s==="u"){for(n=0,t=0;t<4&&(e=parseInt(c(),16),!!isFinite(e));t+=1)n=n*16+e;r+=String.fromCharCode(n)}else if(typeof H[s]=="string")r+=H[s];else break;else r+=s}b("Bad string")}function d(){for(;s&&s<=" ";)c()}function xe(){switch(s){case"t":return c("t"),c("r"),c("u"),c("e"),!0;case"f":return c("f"),c("a"),c("l"),c("s"),c("e"),!1;case"n":return c("n"),c("u"),c("l"),c("l"),null;default:b("Unexpected '"+s+"'")}}function Re(){var e=[];if(s==="["){if(c("["),d(),s==="]")return c("]"),e;for(;s;){if(e.push(x()),d(),s==="]")return c("]"),e;c(","),d()}}b("Bad array")}function we(){var e,t={};if(s==="{"){if(c("{"),d(),s==="}")return c("}"),t;for(;s;){if(e=N(),d(),c(":"),Object.prototype.hasOwnProperty.call(t,e)&&b('Duplicate key "'+e+'"'),t[e]=x(),d(),s==="}")return c("}"),t;c(","),d()}}b("Bad object")}function x(){switch(d(),s){case"{":return we();case"[":return Re();case'"':return N();case"-":return L();default:return s>="0"&&s<="9"?L():xe()}}z.exports=function(e,t){var r;return V=e,I=0,s=" ",r=x(),d(),s&&b("Syntax error"),typeof t=="function"?function n(i,f){var p,u,o=i[f];if(o&&typeof o=="object")for(p in x)Object.prototype.hasOwnProperty.call(o,p)&&(u=n(o,p),typeof u>"u"?delete o[p]:o[p]=u);return t.call(i,f,o)}({"":r},""):r}});var Y=S((He,G)=>{"use strict";var k=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,R,_e={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},A;function F(e){return k.lastIndex=0,k.test(e)?'"'+e.replace(k,function(t){var r=_e[t];return typeof r=="string"?r:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function w(e,t){var r,n,i,f,p=l,u,o=t[e];switch(o&&typeof o=="object"&&typeof o.toJSON=="function"&&(o=o.toJSON(e)),typeof A=="function"&&(o=A.call(t,e,o)),typeof o){case"string":return F(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(l+=R,u=[],Object.prototype.toString.apply(o)==="[object Array]"){for(f=o.length,r=0;r<f;r+=1)u[r]=w(r,o)||"null";return i=u.length===0?"[]":l?`[
`+l+u.join(`,
`+l)+`
`+p+"]":"["+u.join(",")+"]",l=p,i}if(A&&typeof A=="object")for(f=A.length,r=0;r<f;r+=1)n=A[r],typeof n=="string"&&(i=w(n,o),i&&u.push(F(n)+(l?": ":":")+i));else for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=w(n,o),i&&u.push(F(n)+(l?": ":":")+i));return i=u.length===0?"{}":l?`{
`+l+u.join(`,
`+l)+`
`+p+"}":"{"+u.join(",")+"}",l=p,i;default:}}G.exports=function(e,t,r){var n;if(l="",R="",typeof r=="number")for(n=0;n<r;n+=1)R+=" ";else typeof r=="string"&&(R=r);if(A=t,t&&typeof t!="function"&&(typeof t!="object"||typeof t.length!="number"))throw new Error("JSON.stringify");return w("",{"":e})}});var Q=S(q=>{"use strict";q.parse=W();q.stringify=Y()});var Z=S((Ne,X)=>{"use strict";var _=typeof JSON<"u"?JSON:Q(),De=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"},Ee=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r};X.exports=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var r=t.space||"";typeof r=="number"&&(r=Array(r+1).join(" "));var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.replacer||function(u,o){return o},f=t.cmp&&function(u){return function(o){return function(m,a){var O={key:m,value:o[m]},j={key:a,value:o[a]};return u(O,j)}}}(t.cmp),p=[];return function u(o,m,a,O){var j=r?`
`+new Array(O+1).join(r):"",Oe=r?": ":":";if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a=i.call(o,m,a),a!==void 0){if(typeof a!="object"||a===null)return _.stringify(a);if(De(a)){for(var P=[],g=0;g<a.length;g++){var ge=u(a,g,a[g],O+1)||_.stringify(null);P.push(j+r+ge)}return"["+P.join(",")+j+"]"}if(p.indexOf(a)!==-1){if(n)return _.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else p.push(a);for(var M=Ee(a).sort(f&&f(a)),P=[],g=0;g<M.length;g++){var m=M[g],C=u(a,m,a[m],O+1);if(!!C){var be=_.stringify(m)+Oe+C;P.push(j+r+be)}}return p.splice(p.indexOf(a),1),"{"+P.join(",")+j+"}"}}({"":e},"",e,0)}});var Ce={};Pe(Ce,{default:()=>Me});module.exports=Ie(Ce);var h=require("@stoplight/spectral-functions"),v=require("@stoplight/spectral-formats"),de=require("@stoplight/spectral-rulesets");var J;(function(e){e.Simple="simple",e.Matrix="matrix",e.Label="label",e.Form="form",e.CommaDelimited="commaDelimited",e.SpaceDelimited="spaceDelimited",e.PipeDelimited="pipeDelimited",e.DeepObject="deepObject"})(J||(J={}));var y;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information",e[e.Hint=3]="Hint"})(y||(y={}));var T;(function(e){e.Article="article",e.HttpService="http_service",e.HttpServer="http_server",e.HttpOperation="http_operation",e.Model="model",e.Generic="generic",e.Unknown="unknown",e.TableOfContents="table_of_contents",e.SpectralRuleset="spectral_ruleset",e.Styleguide="styleguide",e.Image="image"})(T||(T={}));var U;(function(e){e.Json="json",e.Markdown="markdown",e.Yaml="yaml",e.Javascript="javascript",e.Apng="apng",e.Avif="avif",e.Bmp="bmp",e.Gif="gif",e.Jpeg="jpeg",e.Png="png",e.Svg="svg",e.Webp="webp"})(U||(U={}));var K=e=>e.length<=1?[]:[{message:"Potential misuse of security has been detected"}];var te=require("@stoplight/json-ref-resolver"),ee=Z(),Ve=new te.Resolver,D=async({refOrObject:e,source:t})=>"$ref"in e?(await Ve.resolve(t,{jsonPointer:e.$ref})).result:e,re=({a:e,b:t,comparator:r})=>e.filter(n=>t.filter(i=>r(n,i)).length>0).length>0,$=e=>{if(e==null)throw Error("All references should be dereferenced and non-empty");if("$ref"in e)throw Error("All references should be dereferenced by Spectral already");return e},ne=(e,t)=>{if(e.length!==t.length)return!1;let r=e.map(i=>ee(i)),n=t.map(i=>ee(i));return r.filter(i=>n.includes(i)).length===r.length},ie=(e,t)=>{e!==null&&oe(e,t,[])},oe=(e,t,r)=>{e!==null&&Object.entries(e).forEach(([n,i])=>{let f=[...r];f.push(n),t(n,i,f),typeof i=="object"?oe(i,t,f):t(n,i,f)})};var se=(e,t,r)=>{let n=[],i=r.document.data,f=i.components?.securitySchemes;if(!f)return[];let p=i.security?i.security:e.security;if(!p)return[];if(!e.parameters)return[];let u=e.parameters.map(o=>$(o).name);return p.flatMap(o=>Object.keys(o).map(m=>{let a=$(f[m]);a.type==="http"&&u.includes("Authorization")?n.push({message:"Authorization"}):a.type==="apiKey"&&u.includes(a.name)&&n.push({message:a.name})})),n};var ae=(e,t,r)=>{let n=[],i=r.document.data;return!i.security||!e.security?[]:(ne(i.security,e.security)&&n.push({message:"Detected redundant security schemes."}),n)};var ce=({rule:e,spec:t})=>{let r=t.info;if("x-konfig-ignore"in r){let n=r["x-konfig-ignore"];if(!Array.isArray(n))throw Error("x-konfig-ignore should be list of rule names");return n.includes(e)}return!1};var B="no-additional-properties",ue=(e,t,r)=>{let n=[],i=r.document.data;if(ce({rule:B,spec:i}))return;let f=0,p=0;return ie(i,(u,o,m)=>{typeof o=="object"&&o!==null&&"type"in o&&o.type==="object"&&(m.includes("responses")||m.includes("schemas"))&&(f++,p+=o.additionalProperties?1:0)}),f>0&&p===0&&n.push({message:"Detected potential problem with object types"}),n},fe=`No 'additionalProperties: true' detected on response
bodies throughout spec. Is your spec is 100% compliant with your production API?
If yes, ignore this rule in .spectral.yaml and move on. If no, ignore this rule
in .spectral.yaml by adding "x-konfig-ignore: 'no-additional-properties'" to
top-level OpenAPI Info object and configure your konfig.yaml to intelligently
attach 'additionalProperties: true' to response bodies.`;var pe=e=>{let t=[];if(typeof e!="object"||e===null||!("type"in e)||!("example"in e))return[];let r=e.type;if(typeof r!="string")return[];let n=e.example;return t.push(...ke(r,n)),t},ke=(e,t)=>e==="string"&&typeof t=="string"?Fe(t):[];function Fe(e){return $e(e)?[{message:"Could be integer type based on example"}]:Be(e)?[{message:"Could be number type based on example"}]:qe(e)?[{message:"Could be boolean type based on example"}]:[]}function qe(e){return e==="true"||e==="false"}function $e(e){return/^[-+]?\d+$/.test(e)}function Be(e){var t=/^-?\d+(?:[.,]\d*?)?$/;if(!t.test(e))return!1;let r=parseFloat(e);return!isNaN(r)}var me=async({operation:e,document:t})=>{let r=e.parameters?.map(async n=>D({refOrObject:n,source:t}));if(r!==void 0)return await Promise.all(r)};var le=({security:e})=>{if(e.type==="oauth2"||e.type==="basic"||e.type==="http")return"Authorization";if(e.type==="apiKey")return e.name;throw Error("Not Implemented")};var ye=async({document:e})=>{if("securityDefinitions"in e)return e.securityDefinitions;if("components"in e){let t=e.components?.securitySchemes;if(t===void 0)return;let r=await Promise.all(Object.entries(t).map(async([n,i])=>[n,await D({refOrObject:i,source:e})]));return Object.fromEntries(r)}};var he=async(e,t,r)=>{let n=[],i=r.document.data,f=i.security??e.security;if(f===void 0)return[];let p=await ye({document:i});if(p===void 0)return[];let u=await me({operation:e,document:i});if(u===void 0)return;let o=f.flatMap(m=>Object.keys(m).map(a=>{let O=p[a];if(O===void 0)throw Error(`Found security requirement ${a} referring to non-existent security scheme`);return O}));return re({a:u,b:o,comparator:(m,a)=>m.name===le({security:a})})&&n.push({message:"Detected redundant security requirement and parameter."}),n};var Me={extends:de.oas,aliases:{PathItem:["$.paths[*]"],OperationObject:["#PathItem[get,put,post,delete,options,head,patch,trace]"],ParameterSchemaObject:["#OperationObject.parameters.*.schema"],RequestSchemaObject:["#OperationObject.requestBody.content.*.schema"],ResponseSchemaObject:["#OperationObject.responses.*.content.*.schema"]},rules:{"operation-description":"off","operation-success-response":"off","info-contact":"off","no-http-basic":{description:"Consider a more secure alternative to HTTP Basic",message:"HTTP Basic is a pretty insecure way to pass credentials around, please consider an alternative.",given:"$.components.securitySchemes[*]",then:{field:"scheme",function:h.pattern,functionOptions:{notMatch:"basic"}},severity:y.Error},"no-file-extensions-in-paths":{description:"Paths must not include file extensions such as .json, .xml, .html and .txt",message:"Paths must not include file extensions such as .json, .xml, .html and .txt. Use the OpenAPI `content` keyword to tell consumers which Media Types are available.",given:"$.paths[*]~",then:{function:h.pattern,functionOptions:{notMatch:".(json|xml|html|txt)$"}},severity:y.Error},"adv-security-schemes-defined":{description:"All APIs MUST have a security scheme defined.",message:"This API definition does not have any security scheme defined.",given:"$..components",then:{field:"securitySchemes",function:h.truthy},formats:[v.oas3],severity:y.Error},"adv-security-schemes-defined-oas2":{description:"All APIs MUST have a security scheme defined.",message:"This API definition does not have any security scheme defined.",given:"$",then:{field:"securityDefinitions",function:h.schema,functionOptions:{schema:{type:"object",minProperties:1}}},formats:[v.oas2],severity:y.Error},"list-usage-of-security":{description:"List usage of security implies multiple possible security strategies which is uncommon",message:"Potential misuse of the security field. Only use list when you have multiple security strategies. (i.e. list vs map is significant https://swagger.io/docs/specification/authentication/)",given:["$.security","$.paths..security"],then:{function:K},formats:[v.oas3]},"duplicate-security-and-request-parameters":{description:"Duplicate security and request parameters will cause generated SDKs to have undesired behavior.",message:"Duplicate parameter '{{error}}' in request parameters and security schemes.",given:"#OperationObject",then:{function:se},formats:[v.oas3],severity:y.Error},"operation-operationId":{message:"Operation#operationId is used SDK method and highly recommended to create better SDKs.",given:"#OperationObject",then:{field:"operationId",function:h.truthy}},"redundant-security-schemes":{message:"Remove redundant security schemes from operation object.",given:"#OperationObject",then:{function:ae}},"redundant-security-and-parameter":{message:"Remove redundant security and parameters from operation object.",given:"#OperationObject",then:{function:he},formats:[v.oas2,v.oas3]},[B]:{message:fe,given:"#ResponseSchemaObject",then:{function:ue},severity:y.Error},"potential-data-type":{message:"{{error}}. Ensure your types are correct.",given:["#ResponseSchemaObject..","#RequestSchemaObject..","#ParameterSchemaObject.."],then:{function:pe},severity:y.Error},"limited-oas3_1-support":{message:"Konfig has limited support for OAS 3.1",given:"$.openapi",then:{function:h.pattern,functionOptions:{notMatch:"^3.1.\\d$"}},severity:y.Error},"multiple-tags":{message:"Having more than 1 tag can be confusing as generated SDKs will only show up under one tag.",given:"#OperationObject.tags",then:{function:h.length,functionOptions:{min:1,max:1}},severity:y.Warning}}};0&&(module.exports={});
module.exports = module.exports.default;
//# sourceMappingURL=ruleset.js.map
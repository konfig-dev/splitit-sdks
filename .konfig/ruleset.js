"use strict";var E=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var he=Object.getOwnPropertyNames;var ye=Object.prototype.hasOwnProperty;var I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),de=(e,t)=>{for(var r in t)E(e,r,{get:t[r],enumerable:!0})},ge=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of he(t))!ye.call(e,s)&&s!==r&&E(e,s,{get:()=>t[s],enumerable:!(n=me(t,s))||n.enumerable});return e};var Oe=e=>ge(E({},"__esModule",{value:!0}),e);var N=I((qe,W)=>{"use strict";var P,o,K={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},D;function O(e){throw{name:"SyntaxError",message:e,at:P,text:D}}function a(e){return e&&e!==o&&O("Expected '"+e+"' instead of '"+o+"'"),o=D.charAt(P),P+=1,o}function H(){var e,t="";for(o==="-"&&(t="-",a("-"));o>="0"&&o<="9";)t+=o,a();if(o===".")for(t+=".";a()&&o>="0"&&o<="9";)t+=o;if(o==="e"||o==="E")for(t+=o,a(),(o==="-"||o==="+")&&(t+=o,a());o>="0"&&o<="9";)t+=o,a();return e=Number(t),isFinite(e)||O("Bad number"),e}function L(){var e,t,r="",n;if(o==='"')for(;a();){if(o==='"')return a(),r;if(o==="\\")if(a(),o==="u"){for(n=0,t=0;t<4&&(e=parseInt(a(),16),!!isFinite(e));t+=1)n=n*16+e;r+=String.fromCharCode(n)}else if(typeof K[o]=="string")r+=K[o];else break;else r+=o}O("Bad string")}function d(){for(;o&&o<=" ";)a()}function be(){switch(o){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null;default:O("Unexpected '"+o+"'")}}function ve(){var e=[];if(o==="["){if(a("["),d(),o==="]")return a("]"),e;for(;o;){if(e.push(x()),d(),o==="]")return a("]"),e;a(","),d()}}O("Bad array")}function je(){var e,t={};if(o==="{"){if(a("{"),d(),o==="}")return a("}"),t;for(;o;){if(e=L(),d(),a(":"),Object.prototype.hasOwnProperty.call(t,e)&&O('Duplicate key "'+e+'"'),t[e]=x(),d(),o==="}")return a("}"),t;a(","),d()}}O("Bad object")}function x(){switch(d(),o){case"{":return je();case"[":return ve();case'"':return L();case"-":return H();default:return o>="0"&&o<="9"?H():be()}}W.exports=function(e,t){var r;return D=e,P=0,o=" ",r=x(),d(),o&&O("Syntax error"),typeof t=="function"?function n(s,f){var p,u,i=s[f];if(i&&typeof i=="object")for(p in x)Object.prototype.hasOwnProperty.call(i,p)&&(u=n(i,p),typeof u>"u"?delete i[p]:i[p]=u);return t.call(s,f,i)}({"":r},""):r}});var G=I(($e,z)=>{"use strict";var k=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,m,w,Ae={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b;function V(e){return k.lastIndex=0,k.test(e)?'"'+e.replace(k,function(t){var r=Ae[t];return typeof r=="string"?r:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function R(e,t){var r,n,s,f,p=m,u,i=t[e];switch(i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(e)),typeof b=="function"&&(i=b.call(t,e,i)),typeof i){case"string":return V(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(m+=w,u=[],Object.prototype.toString.apply(i)==="[object Array]"){for(f=i.length,r=0;r<f;r+=1)u[r]=R(r,i)||"null";return s=u.length===0?"[]":m?`[
`+m+u.join(`,
`+m)+`
`+p+"]":"["+u.join(",")+"]",m=p,s}if(b&&typeof b=="object")for(f=b.length,r=0;r<f;r+=1)n=b[r],typeof n=="string"&&(s=R(n,i),s&&u.push(V(n)+(m?": ":":")+s));else for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(s=R(n,i),s&&u.push(V(n)+(m?": ":":")+s));return s=u.length===0?"{}":m?`{
`+m+u.join(`,
`+m)+`
`+p+"}":"{"+u.join(",")+"}",m=p,s;default:}}z.exports=function(e,t,r){var n;if(m="",w="",typeof r=="number")for(n=0;n<r;n+=1)w+=" ";else typeof r=="string"&&(w=r);if(b=t,t&&typeof t!="function"&&(typeof t!="object"||typeof t.length!="number"))throw new Error("JSON.stringify");return R("",{"":e})}});var Y=I(F=>{"use strict";F.parse=N();F.stringify=G()});var X=I((Je,Q)=>{"use strict";var _=typeof JSON<"u"?JSON:Y(),Se=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"},Ie=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r};Q.exports=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var r=t.space||"";typeof r=="number"&&(r=Array(r+1).join(" "));var n=typeof t.cycles=="boolean"?t.cycles:!1,s=t.replacer||function(u,i){return i},f=t.cmp&&function(u){return function(i){return function(l,c){var A={key:l,value:i[l]},v={key:c,value:i[c]};return u(A,v)}}}(t.cmp),p=[];return function u(i,l,c,A){var v=r?`
`+new Array(A+1).join(r):"",fe=r?": ":":";if(c&&c.toJSON&&typeof c.toJSON=="function"&&(c=c.toJSON()),c=s.call(i,l,c),c!==void 0){if(typeof c!="object"||c===null)return _.stringify(c);if(Se(c)){for(var S=[],g=0;g<c.length;g++){var pe=u(c,g,c[g],A+1)||_.stringify(null);S.push(v+r+pe)}return"["+S.join(",")+v+"]"}if(p.indexOf(c)!==-1){if(n)return _.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else p.push(c);for(var C=Ie(c).sort(f&&f(c)),S=[],g=0;g<C.length;g++){var l=C[g],J=u(c,l,c[l],A+1);if(!!J){var le=_.stringify(l)+fe+J;S.push(v+r+le)}}return p.splice(p.indexOf(c),1),"{"+S.join(",")+v+"}"}}({"":e},"",e,0)}});var De={};de(De,{default:()=>Ee});module.exports=Oe(De);var y=require("@stoplight/spectral-functions"),j=require("@stoplight/spectral-formats"),ue=require("@stoplight/spectral-rulesets");var M;(function(e){e.Simple="simple",e.Matrix="matrix",e.Label="label",e.Form="form",e.CommaDelimited="commaDelimited",e.SpaceDelimited="spaceDelimited",e.PipeDelimited="pipeDelimited",e.DeepObject="deepObject"})(M||(M={}));var h;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information",e[e.Hint=3]="Hint"})(h||(h={}));var T;(function(e){e.Article="article",e.HttpService="http_service",e.HttpServer="http_server",e.HttpOperation="http_operation",e.Model="model",e.Generic="generic",e.Unknown="unknown",e.TableOfContents="table_of_contents",e.SpectralRuleset="spectral_ruleset",e.Styleguide="styleguide",e.Image="image"})(T||(T={}));var U;(function(e){e.Json="json",e.Markdown="markdown",e.Yaml="yaml",e.Javascript="javascript",e.Apng="apng",e.Avif="avif",e.Bmp="bmp",e.Gif="gif",e.Jpeg="jpeg",e.Png="png",e.Svg="svg",e.Webp="webp"})(U||(U={}));var B=e=>e.length<=1?[]:[{message:"Potential misuse of security has been detected"}];var Z=X(),q=e=>{if(e==null)throw Error("All references should be dereferenced and non-empty");if("$ref"in e)throw Error("All references should be dereferenced by Spectral already");return e},ee=(e,t)=>{if(e.length!==t.length)return!1;let r=e.map(s=>Z(s)),n=t.map(s=>Z(s));return r.filter(s=>n.includes(s)).length===r.length},te=(e,t)=>{e!==null&&re(e,t,[])},re=(e,t,r)=>{e!==null&&Object.entries(e).forEach(([n,s])=>{let f=[...r];f.push(n),t(n,s,f),typeof s=="object"?re(s,t,f):t(n,s,f)})};var ne=(e,t,r)=>{let n=[],s=r.document.data,f=s.components?.securitySchemes;if(!f)return[];let p=s.security?s.security:e.security;if(!p)return[];if(!e.parameters)return[];let u=e.parameters.map(i=>q(i).name);return p.flatMap(i=>Object.keys(i).map(l=>{let c=q(f[l]);c.type==="http"&&u.includes("Authorization")?n.push({message:"Authorization"}):c.type==="apiKey"&&u.includes(c.name)&&n.push({message:c.name})})),n};var ie=(e,t,r)=>{let n=[],s=r.document.data;return!s.security||!e.security?[]:(ee(s.security,e.security)&&n.push({message:"Detected redundant security schemes."}),n)};var oe=({rule:e,spec:t})=>{let r=t.info;if("x-konfig-ignore"in r){let n=r["x-konfig-ignore"];if(!Array.isArray(n))throw Error("x-konfig-ignore should be list of rule names");return n.includes(e)}return!1};var $="no-additional-properties",se=(e,t,r)=>{let n=[],s=r.document.data;if(oe({rule:$,spec:s}))return;let f=0,p=0;return te(s,(u,i,l)=>{typeof i=="object"&&i!==null&&"type"in i&&i.type==="object"&&(l.includes("responses")||l.includes("schemas"))&&(f++,p+=i.additionalProperties?1:0)}),f>0&&p===0&&n.push({message:"Detected potential problem with object types"}),n},ae=`No 'additionalProperties: true' detected on response
bodies throughout spec. Is your spec is 100% compliant with your production API?
If yes, ignore this rule in .spectral.yaml and move on. If no, ignore this rule
in .spectral.yaml by adding "x-konfig-ignore: 'no-additional-properties'" to
top-level OpenAPI Info object and configure your konfig.yaml to intelligently
attach 'additionalProperties: true' to response bodies.`;var ce=e=>{let t=[];if(typeof e!="object"||e===null||!("type"in e)||!("example"in e))return[];let r=e.type;if(typeof r!="string")return[];let n=e.example;return t.push(...Pe(r,n)),t},Pe=(e,t)=>e==="string"&&typeof t=="string"?xe(t):[];function xe(e){return Re(e)?[{message:"Could be integer type based on example"}]:_e(e)?[{message:"Could be number type based on example"}]:we(e)?[{message:"Could be boolean type based on example"}]:[]}function we(e){return e==="true"||e==="false"}function Re(e){return/^[-+]?\d+$/.test(e)}function _e(e){var t=/^-?\d+(?:[.,]\d*?)?$/;if(!t.test(e))return!1;let r=parseFloat(e);return!isNaN(r)}var Ee={extends:ue.oas,aliases:{PathItem:["$.paths[*]"],OperationObject:["#PathItem[get,put,post,delete,options,head,patch,trace]"],ParameterSchemaObject:["#OperationObject.parameters.*.schema"],RequestSchemaObject:["#OperationObject.requestBody.content.*.schema"],ResponseSchemaObject:["#OperationObject.responses.*.content.*.schema"]},rules:{"operation-description":"off","operation-success-response":"off","info-contact":"off","no-http-basic":{description:"Consider a more secure alternative to HTTP Basic",message:"HTTP Basic is a pretty insecure way to pass credentials around, please consider an alternative.",given:"$.components.securitySchemes[*]",then:{field:"scheme",function:y.pattern,functionOptions:{notMatch:"basic"}},severity:h.Error},"no-file-extensions-in-paths":{description:"Paths must not include file extensions such as .json, .xml, .html and .txt",message:"Paths must not include file extensions such as .json, .xml, .html and .txt. Use the OpenAPI `content` keyword to tell consumers which Media Types are available.",given:"$.paths[*]~",then:{function:y.pattern,functionOptions:{notMatch:".(json|xml|html|txt)$"}},severity:h.Error},"adv-security-schemes-defined":{description:"All APIs MUST have a security scheme defined.",message:"This API definition does not have any security scheme defined.",given:"$..components",then:{field:"securitySchemes",function:y.truthy},formats:[j.oas3],severity:h.Error},"adv-security-schemes-defined-oas2":{description:"All APIs MUST have a security scheme defined.",message:"This API definition does not have any security scheme defined.",given:"$",then:{field:"securityDefinitions",function:y.schema,functionOptions:{schema:{type:"object",minProperties:1}}},formats:[j.oas2],severity:h.Error},"list-usage-of-security":{description:"List usage of security implies multiple possible security strategies which is uncommon",message:"Potential misuse of the security field. Only use list when you have multiple security strategies. (i.e. list vs map is significant https://swagger.io/docs/specification/authentication/)",given:["$.security","$.paths..security"],then:{function:B},formats:[j.oas3]},"duplicate-security-and-request-parameters":{description:"Duplicate security and request parameters will cause generated SDKs to have undesired behavior.",message:"Duplicate parameter '{{error}}' in request parameters and security schemes.",given:"#OperationObject",then:{function:ne},formats:[j.oas3],severity:h.Error},"operation-operationId":{message:"Operation#operationId is used SDK method and highly recommended to create better SDKs.",given:"#OperationObject",then:{field:"operationId",function:y.truthy}},"redundant-security-schemes":{message:"Remove redundant security schemes from operation object.",given:"#OperationObject",then:{function:ie}},[$]:{message:ae,given:"#ResponseSchemaObject",then:{function:se},severity:h.Error},"potential-data-type":{message:"{{error}}. Ensure your types are correct.",given:["#ResponseSchemaObject..","#RequestSchemaObject..","#ParameterSchemaObject.."],then:{function:ce},severity:h.Error},"limited-oas3_1-support":{message:"Konfig has limited support for OAS 3.1",given:"$.openapi",then:{function:y.pattern,functionOptions:{notMatch:"^3.1.\\d$"}},severity:h.Error},"multiple-tags":{message:"Having more than 1 tag can be confusing as generated SDKs will only show up under one tag.",given:"#OperationObject.tags",then:{function:y.length,functionOptions:{min:1,max:1}},severity:h.Warning}}};0&&(module.exports={});
module.exports = module.exports.default;
//# sourceMappingURL=ruleset.js.map